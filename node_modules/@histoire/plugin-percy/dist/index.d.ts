import type { Plugin } from 'histoire';
import type { Page, WaitForOptions } from 'puppeteer';
/**
 * Percy Snapshot Options
 * Not official type, just for reference
 * @see https://www.browserstack.com/docs/percy/take-percy-snapshots/snapshots-via-scripts
 */
export interface PercySnapshotOptions {
    widths?: number[];
    minHeight?: number;
    percyCSS?: string;
    enableJavaScript?: boolean;
    discovery?: Partial<{
        allowedHostnames: string[];
        disallowedHostnames: string[];
        requestHeaders: Record<string, string>;
        authorization: Partial<{
            username: string;
            password: string;
        }>;
        disableCache: boolean;
        userAgent: string;
    }>;
}
export interface PagePayload {
    file: string;
    story: {
        title: string;
    };
    variant: {
        id: string;
        title: string;
    };
}
type ContructorOption<T extends object | number> = T | ((payload: PagePayload) => T);
export interface PercyPluginOptions {
    /**
     * Ignored stories.
     */
    ignored?: (payload: PagePayload) => boolean;
    /**
     * Percy options.
     */
    percyOptions?: ContructorOption<PercySnapshotOptions>;
    /**
     * Delay puppeteer page screenshot after page load
     */
    pptrWait?: ContructorOption<number>;
    /**
     * Navigation Parameter
     */
    pptrOptions?: ContructorOption<WaitForOptions & {
        referer?: string;
    }>;
    /**
     * Before taking a snapshot, you can modify the page
     * It happens after the page is loaded and wait (if pptrWait is passed) and before the snapshot is taken
     *
     * @param page Puppeteer page
     * @returns Promise<void | boolean> - If it returns false, the snapshot will be skipped
     */
    beforeSnapshot?: (page: Page, payload: PagePayload) => Promise<void | boolean>;
}
export declare function HstPercy(options?: PercyPluginOptions): Plugin;
export {};
